### Shim در مفهوم Docker

در مفهوم Docker یک عامل واسط بین Docker Daemon و Containerd است. در واقع، shim نقش یک adapter یا ترجمه‌گر (translator) را ایفا می‌کند. به طور کلی، این شامل دو قسمت اصلی است:

#### 1. پردازه Shim (Shim Process):

این یک پردازه کوچک است که به عنوان واسط بین Docker Daemon و Containerd عمل می‌کند. پردازه shim از Docker Daemon درخواست‌هایی را که نیاز به تعامل با کانتینر دارد دریافت کرده و این درخواست‌ها را به زبانی قابل درک برای Containerd ترجمه می‌کند.

#### 2. تبادل اطلاعات Shim (Shim RPC):

این یک روش تبادل اطلاعات بین shim و Containerd است. این تبادل اطلاعات برای کنترل و مدیریت کانتینرها و اجرای آنها از سوی Docker Daemon انجام می‌شود.

استفاده از shim به سیستم اجازه می‌دهد تا با استفاده از واسط یکپارچه‌تر و تبادل اطلاعات استاندارد، با تعدادی از سیستم‌های مدیریت کانتینر (Containerd در اینجا) ارتباط برقرار کند. این معماری از انعطاف بیشتری برخوردار است و به اجزای Docker اجازه می‌دهد که با قابلیت و پایداری بیشتر به عنوان یک سیستم مدیریت کانتینر عمل کنند.

### وظایف اصلی Shim در Docker

1. **جداسازی فرآیند اصلی Docker از فرآیندهای کانتینر:**
   - زمانی که یک کانتینر راه‌اندازی می‌شود، فرآیند dockerd (دایمون Docker) فرآیند اصلی کانتینر را به یک shim واگذار می‌کند. این کار باعث می‌شود که:
     - اگر دایمون Docker کرش کند یا از بین برود، فرآیند کانتینر همچنان زنده بماند.
     - فرآیند کانتینر از فرآیند دایمون مستقل باشد.

2. **مدیریت سیگنال‌ها:**
   - شیم مسئول دریافت و ارسال سیگنال‌ها بین میزبان و فرآیند کانتینر است. به‌عنوان مثال، اگر یک سیگنال مانند SIGTERM به کانتینر ارسال شود، shim آن را به فرآیند اصلی کانتینر منتقل می‌کند.

3. **مدیریت ورودی/خروجی (I/O):**
   - شیم جریان‌های ورودی/خروجی (مانند stdin، stdout و stderr) را بین میزبان و فرآیند کانتینر مدیریت می‌کند.

4. **ساده‌سازی اجرای کانتینر:**
   - شیم باعث می‌شود که اجرای کانتینر ساده‌تر شود و نیاز نباشد که دایمون Docker مستقیماً با فرآیندهای کانتینر تعامل داشته باشد.

