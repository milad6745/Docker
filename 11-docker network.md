# ِdocker network

مفاهیم اولیه شبکه در Docker
یک شبکه در Docker همانند یک کانتینر و تصویر، یک شئ منطقی دیگر است. همانند دو شئ دیگر، یک تعداد زیادی دستور زیر گروه دستورات docker network برای مدیریت شبکه‌ها وجود دارد.

برای لیست کردن شبکه‌های موجود در سیستم‌تان، دستور زیر را اجرا کنید:

```bash
docker network ls
```

```
# NETWORK ID     NAME      DRIVER    SCOPE
# c2e59f2b96bd   bridge    bridge    local
# 124dccee067f   host      host      local
# 506e3822bf1f   none      null      local
```

شما باید سه شبکه در سیستم خود ببینید. حالا به ستون DRIVER در این جدول نگاه کنید. این درایورها به عنوان نوع شبکه مورد استفاده می‌توانند قرار بگیرند.

به طور پیش‌فرض، Docker پنج درایور شبکه دارد. این‌ها به شرح زیر هستند:

- **bridge**:
-
-   درایور معمولی شبکه در Docker. این برای زمانی استفاده می‌شود که چندین کانتینر در حال اجرا در حالت استاندارد هستند و نیاز به ارتباط با یکدیگر دارند.
  
- **host**:
-
- شبکه را به طور کامل حذف می‌کند. هر کانتینری که در یک شبکه میزبان قرار دارد، به طور اصلی به شبکه سیستم میزبان متصل است.

- **none**:
-
- این درایور شبکه را برای کانتینرها کاملاً غیرفعال می‌کند. من هنوز مورد استفاده‌ای برای این درایور پیدا نکردم.

- **overlay**:


توی این نوع نتورک درایور overlay یک شبکه overlay که قابلیت پشتیبانی مالتی هاست رو هم داره ایجاد میکنه و با استفاده از ترکیب شبکه بریج داخلی لینوکس و VXLAN امکان ارتباط بین کانتینرها رو بر بستری روی شبکه فیزیکی ایجاد میکنه. تو این نتورک ما می‌تونیم Multi host networking داشته باشیم. امکانی که بهمون کمک می‌کنه تا کانتینرهای داخل هاست اول با کانتینرهای داخل هاست دوم داخل یک شبکه بوده و بتونن باهم صحبت کنند. تو این نتورک Routing و Switching انجام می‌شه.


![image](https://github.com/user-attachments/assets/025cca53-b315-4838-8763-c6e03e40e0a0)



- **macvlan**:

توی این نوع نتورک میتونیم شبکه های مجازی رو ایجاد کنیم که کانتینرها در لایه دو و از طریق مک آدرس بتونن توی اون شبکه با هم ارتباط داشته باشند. این مورد بیشتر برای سرویس‌های قدیمی کاربرد داره که دوست دارند با کانتینرها همانند VM‌ها توی شبکه برخورد کنند. تو این شبکه انگار هر کانتینر ما یه VM هست و از طریق مک آدرسی که داره در دسترس هست و یه روش خوب برای ماگریت کردن از VM به Container هست. البته که هزینه‌ی بالایی داره چون از رنج هاست داریم بهشون آی‌پی می‌دیم و این برامون مطلوب نیست. از این نتورک هم خیلی کم استفاده می‌شه.


![image](https://github.com/user-attachments/assets/4095805a-3ef2-40ba-9380-909a56a15cac)



### 1. ایجاد یک Bridge جدید:

```bash
docker network create my_bridge_network
```

در اینجا `my_bridge_network` نام شبکه جدید است. شما می‌توانید نام دلخواه دیگری انتخاب کنید.

### 2. اجرای یک کانتینر و اختصاص به شبکه جدید:

```bash
docker run -d --name my_container --network my_bridge_network nginx
```

در اینجا:

- `-d`: به کانتینر را در حالت پس‌زمینه اجرا می‌کند.
- `--name my_container`: به کانتینر یک نام مشخص (در اینجا `my_container`) اختصاص می‌دهد.
- `--network my_bridge_network`: کانتینر را به شبکه bridge جدید متصل می‌کند.
- `nginx`: تصویر مورد استفاده برای اجرای کانتینر. شما می‌توانید تصویر دلخواه خود را جایگزین کنید.

حالا کانتینر `my_container` به شبکه `my_bridge_network` متصل شده است. این به این معناست که کانتینر در شبکه bridge جدید شما قرار دارد و می‌تواند با دیگر کانتینرهای متصل به همین شبکه ارتباط برقرار کند.

می‌توانید با اجرای دستور `docker network inspect my_bridge_network` جزئیات بیشتری از شبکه جدید را بررسی کنید.

```bash
docker network inspect my_bridge_network
```

در اینجا، شما باید اطلاعاتی مشابه زیر را ببینید که نشان‌دهنده این است که کانتینر متصل به شبکه است:

```json
[
    {
        "Name": "my_bridge_network",
        "Driver": "bridge",
        "IPAM": {
            "Config": [
                {
                    "Subnet": "172.18.0.0/16"
                }
            ]
        },
        "Containers": {
            "container_id": {
                "Name": "my_container",
                "EndpointID": "endpoint_id",
                "MacAddress": "mac_address",
                "IPv4Address": "172.18.0.2/16",
                "IPv6Address": ""
            }
        }
    }
]
```

در این مثال، `container_id`، `endpoint_id` و `mac_address` مقادیر واقعی نیستند و باید با مقادیر واقعی شما جایگزین شوند.


 **مقایسه با شبکه bridge**


network host: 
    
در این حالت، کانتینر مستقیماً به شبکه میزبان متصل می‌شود. پورت‌های میزبان به صورت مستقیم در دسترس هستند و نیازی به انتشار (expose) پورت‌ها نیست. اما نمی‌توانید دو سرویس مشابه روی یک پورت یکسان اجرا کنید.
    
network bridge: 
    
در این حالت، کانتینر در یک شبکه مجازی جداگانه اجرا می‌شود و برای دسترسی به پورت‌های کانتینر باید پورت‌ها را به صورت دستی منتشر کنید (publish). این روش به صورت پیش‌فرض ایزوله است.
    

**تفاوت‌ها:**

پورت‌ها: در شبکه host، کانتینرها مستقیماً از پورت‌های میزبان استفاده می‌کنند. در حالی که در شبکه bridge، شما باید پورت‌های میزبان را به پورت‌های کانتینر متصل کنید.
    
عملکرد: شبکه host ممکن است کمی سریع‌تر باشد، زیرا نیازی به NAT بین میزبان و کانتینر نیست.
    
امنیت: شبکه bridge معمولاً امن‌تر است زیرا کانتینرها به‌طور پیش‌فرض از شبکه میزبان ایزوله هستند.



Network Management Commands:
در ادامه کامند لاین Network رو می‌بینید که بهتون کمک می‌کنه تا نتورک‌ها رو مدیریت کنیم.
docker network connect: Connect a container to a network

docker network create: Create a network

docker network disconnect: Disconnect a container from a network

docker network inspect: Display detailed information

docker network ls: List networks

docker network prune: Remove all unused networks

docker network rm: Remove one or more networks
